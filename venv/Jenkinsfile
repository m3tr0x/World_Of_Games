pipeline {
	agent any
	stages {
		stage('Build Test Env.') {
			steps {
				echo 'Building test environment'
				sh "cd 'C:\\Users\\aviv0\\PycharmProjects\\World_Of_Games2\\venv'"
				cmd_exec('docker-machine start')
				cmd_exec('docker-compose up')
				echo 'Finished Building test environment'
			}
		}
		stage ("Intialization") {
			steps {
				echo 'Waiting 5 minutes for deployment to complete prior start testing'
				sleep 300 
			}
		}
		stage('Testing') {
			steps {
				echo 'Starting the Test'
				sh "cd 'C:\\Users\\aviv0\\PycharmProjects\\World_Of_Games2\\venv\\tests'"
				bat 'python e2e.py'	
			}
		}
		stage('Shutdown Test Env.') {
			steps {
				echo 'shutting down testing environment'
				sh "cd 'C:\\Users\\aviv0\\PycharmProjects\\World_Of_Games2\\venv'"
				cmd_exec('docker-machine stop')
			}
		}
	}
}
